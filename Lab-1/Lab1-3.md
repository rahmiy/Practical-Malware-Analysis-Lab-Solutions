# Lab1-3 Sorular

Bu lab uygulamasında `Practical Malware Analysis` kitabıyla birlikte verilmiş olan `Lab01-02.exe` dosyası üzerinden analiz gerçekleştirilecek ve sorulan sorularak cevaplar verilmeye çalışılacaktır. 

Bu içeriklerin amacı, direkt olarak sorulan sorulara cevap vermek değil, aynı zamanda malware analizi konusunda aydınlatıcı ve faydalı bir içerik havuzu oluşturmaktadır. Gerektiği yerlerde detaya girilecektir. Zaten kitabı aldıysanız, kitabın bir bölümü bu soruların cevaplarını detaylı bir şekilde veriyor. Burada amaç, cevapların içerisinde gizli kalmış, değinilmesi gereken konulara da değinerek bir fayda sağlabilmek. O halde başlayalım.

İlk sorumuz,

1- Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?

Dosyamız virustotal'e yüklendiği vakit, 64 antivürüs motoru tarafından zararlı olarak algılanmıştır.

2- Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

Dosyamızı PEiD ile incelediğimiz vakit `FSG 1.0 -> dulek/xt` packer'ı ile paketlendiğini görmekteyiz. Paketleme işlemleri genel olarak malware geliştiricileri tarafından, antivürüslere yakalanmaması için yapılmaktadır. Lakin demode ve eski yöntemler çok rahat bir şekilde günümüz antivürüsleri tarafından rahatlıkla tespit edilebilmektedir. Şimdi unpack etme işleminde ise, ollydbg uygulamasını kullanacağız. İlk olarak OEP noktasını aşağıdaki gibi buluyoruz. 

--image gelecek--

Bu işlemden sonra programın başlangıç noktasını `00401090` adresinde bulmuş oluyoruz. Kodumuzun burası daha analiz edilmemiş durumda, sağ clikle tıklayıp, `Analysis->Analyse Code` diyoruz.

Daha sonra aşağıdaki görseldeki gibi `Plugins->OllyDump->Dump Debugged Process` yolunu izleyip, çıkan ekrandan **dump'a basıp,** dosyamızı unpack etmiş oluyoruz.

--image gelecek--

3- Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?

Dosyamız unpack edildikten sonra `msvcrt.dll`, `oleaut32.dll` ve `ole32.dll` dosyalarının import edildiğini görmekteyiz. Bu dll dosyalarından ole32.dll'e ait olan `CoCreateInstance` fonksiyonu dikkat çekicidir.

4- What host or network-based indicators could be used to identify this malware on infected machines?

Aşağıdaki indicator'ler tespit için kullanılabilir.

http://www.malwareanalysisbook.com/ad.html




