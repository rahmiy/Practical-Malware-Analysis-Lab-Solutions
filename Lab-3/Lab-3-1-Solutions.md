# Lab3-1 Sorular

Bu lab uygulamasında `Practical Malware Analysis` kitabıyla birlikte verilmiş olan `Lab03-01.exe` dosyası üzerinden analiz gerçekleştirilecek ve sorulan sorularak cevaplar verilmeye çalışılacaktır. 

Bu içeriklerin amacı, direkt olarak sorulan sorulara cevap vermek değil, aynı zamanda malware analizi konusunda aydınlatıcı ve faydalı bir içerik havuzu oluşturmaktadır. Gerektiği yerlerde detaya girilecektir. Zaten kitabı aldıysanız, kitabın bir bölümü bu soruların cevaplarını detaylı bir şekilde veriyor. Burada amaç, cevapların içerisinde gizli kalmış, değinilmesi gereken konulara da değinerek bir fayda sağlabilmek. O halde başlayalım.

İlk sorumuz,

**1- What are this malware's imports and strings?**

Lab uygulamalarında bu seride basic dynamic analysis teknikleri kullanılacaktır. Lakin ilk sorumuz, static analiz ile alakalıdır. 

Lab03-01.exe'nin importlarına dependecy walker ile baktığımızda; Kernel32.dll dosyasının import edildiğini ve bunun altında da `API-MS-WIN-SERVICE|CORE-*.dll` ifadesi ile başlayan birçok dll dosyasının import edildiğini görmekteyiz. Bu dll dosyaları WIN32 APIs diye adlandırılan exported fonksiyonları bünyelerinde barındırmaktadır. Aşağıdaki görselden daha detaylı bir şekilde inceleyebilirsiniz.

![](/Lab-3/images/Lab3-1-image.png "lab3")

Windows 7 kernel dll mimarisini öğrenmek için [bu linki inceleyebilirsiniz.](https://www.nirsoft.net/articles/windows_7_kernel_architecture_changes.html)

String ifadeler için ise PEstudio tarafından çıkarılmış string değerleri aşağıdaki görsel üzerinden inceleyim.

![](/Lab-3/images/Lab3-1-image2.png "lab3")

**2- What are the malware's host-based indicators?**

Bu aşamada artık dinamik analiz tekniklere geçiyoruz. Bu aşamada procmon uygulamasında, filter kısmından aşağıdaki görselde bulunan filtreleme işlemini uyguluyoruz. 

![](/Lab-3/images/Lab3-1-image3.png "lab3")

Bu filtreleme işleminden sonra Lab03-01.exe zararlısını çalıştırdığımızda 3 işlem dikkatimizi çekiyor. Bunlar;

- CreateFile
- WriteFile
- RegSetValue işlemleridir.  

Aşağıda bu işlemlerden dikkat çekici olanlar procmon üzerinden görülmektedir.

![](/Lab-3/images/Lab3-1-image4.png "lab3")

Burada belirtilenlerden ayrı, binlerce işlem var. Bunların içerisinde elbette dikkat çekici birçok işlem bulunmaktadır. Lakin bunların hepsini tek tek incelemek mantıklı bir iş değildir. Eğer malware analizcisi olacaksanız, ufak detaylardan büyük resmi görme yeteneğini elde etmeniz gerekmekte. Sorumuz olan host-based inditicator'ler aşağıdaki gibidir.

- System32 klasöründeki vmx32to64.exe uygulaması
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VideoDriver
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components {İçeriğindeki değişiklikler regShot ile izlenmeli}

**3- Are there any useful metwork-based signatures for this malware? If so, what are they?**

Network tabanlı indicatorler de ise dikkatimizi aşağıdaki URL adresi çekiyor. Zararlı bir süre sonra bu URL'ye bağlanmaya çalışmaktadır. 

- www.practicalmalwareanalysis.com





